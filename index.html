<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Clearview Consultoria</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-black: #050505;
            --card-grey: #141414;
            --input-bg: #1f1f1f;
            --text-white: #ffffff;
            --text-muted: #888888;
            --accent-yellow: #ffcc00;
            --border-color: #2a2a2a;
            --success: #00e676;
            --danger: #ff5252;
        }

        * {
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            outline: none;
        }

        body {
            background-color: var(--bg-black);
            color: var(--text-white);
            padding: 20px;
            padding-bottom: 100px;
        }

        /* --- HEADER & LOGO --- */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 10px;
        }

        .brand-logo {
            font-size: 1.6rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            color: white;
            display: inline-block;
            margin-bottom: 5px;
            border: 1px solid var(--accent-yellow);
            padding: 5px 15px;
            border-radius: 4px;
        }
        
        .brand-logo span { color: var(--accent-yellow); }

        h2 { font-size: 0.9rem; color: var(--text-muted); font-weight: 400; margin-top: 5px; }
        .client-name { color: var(--text-white); font-weight: 600; }

        /* --- CARDS --- */
        .card {
            background: var(--card-grey);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }

        .card-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent-yellow);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* --- INPUTS CUSTOMIZADOS --- */
        .input-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .input-label {
            font-size: 0.9rem;
            color: #ccc;
            flex: 1;
        }

        .money-input {
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.95rem;
            text-align: right;
            width: 130px;
            transition: border-color 0.3s;
        }

        .money-input:focus {
            border-color: var(--accent-yellow);
        }

        /* --- GRÁFICO --- */
        .chart-wrapper {
            position: relative;
            height: 180px;
            margin: 10px 0 20px 0;
        }

        .total-display {
            text-align: center;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .total-label {
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: -10px;
            margin-bottom: 15px;
        }

        /* --- BARRAS DE GASTOS --- */
        .expense-bar-bg {
            height: 4px;
            background: #222;
            width: 100%;
            margin-top: 5px;
            border-radius: 2px;
        }
        .expense-bar-fill {
            height: 100%;
            background: var(--text-muted);
            width: 0%;
            border-radius: 2px;
            transition: width 0.5s;
        }

        /* --- RESULTADOS --- */
        .result-box {
            background: rgba(255, 204, 0, 0.1);
            border: 1px solid var(--accent-yellow);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .big-result {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--accent-yellow);
            display: block;
        }

        .saving-rate {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        /* --- CALCULADORA ESPECÍFICA --- */
        .calc-btn {
            background: var(--accent-yellow);
            color: black;
            border: none;
            width: 100%;
            padding: 14px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            text-transform: uppercase;
            box-shadow: 0 4px 0 #b38f00; /* Efeito 3D botão */
            transition: transform 0.1s;
        }
        .calc-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #b38f00;
        }

        .calc-result-area {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px dashed var(--border-color);
            display: none;
        }

    </style>
</head>
<body>

    <header>
        <div class="brand-logo">Clearview <span>Consultoria</span></div>
        <h2>Painel do Cliente: <span class="client-name">Fernando Sanga</span></h2>
    </header>

    <div class="card">
        <div class="card-header">
            <span class="card-title">Distribuição de Ativos</span>
        </div>

        <div class="total-display" id="totalPatrimonio">R$ 0,00</div>
        <div class="total-label">Patrimônio Total Acumulado</div>

        <div class="chart-wrapper">
            <canvas id="investChart"></canvas>
        </div>

        <div class="input-row">
            <label class="input-label">Renda Fixa</label>
            <input type="tel" class="money-input" id="valRF" value="10000" onkeyup="formatMask(this); updateDashboard()">
        </div>
        <div class="input-row">
            <label class="input-label">Renda Variável</label>
            <input type="tel" class="money-input" id="valRV" value="5000" onkeyup="formatMask(this); updateDashboard()">
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="card-title">Fluxo Mensal</span>
        </div>

        <div class="input-row">
            <label class="input-label" style="color: var(--success); font-weight: bold;">Salário Líquido</label>
            <input type="tel" class="money-input" id="valSalario" value="2500" style="color: var(--success); border-color: var(--success);" onkeyup="formatMask(this); updateDashboard()">
        </div>

        <div id="expenses-container">
            <div class="input-row">
                <label class="input-label">Moradia</label>
                <input type="tel" class="money-input expense-input" value="800" onkeyup="formatMask(this); updateDashboard()">
            </div>
            
            <div class="input-row">
                <label class="input-label">Alimentação</label>
                <input type="tel" class="money-input expense-input" value="200" onkeyup="formatMask(this); updateDashboard()">
            </div>

            <div class="input-row">
                <label class="input-label">Cartão de Crédito</label>
                <input type="tel" class="money-input expense-input" value="200" onkeyup="formatMask(this); updateDashboard()">
            </div>

            <div class="input-row">
                <label class="input-label">Lazer / Outros</label>
                <input type="tel" class="money-input expense-input" value="300" onkeyup="formatMask(this); updateDashboard()">
            </div>
        </div>

        <div class="result-box">
            <span style="font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px;">Sobra para Aporte</span>
            <span class="big-result" id="valAporte">R$ 1.000,00</span>
            <div class="saving-rate" id="taxaPoupanca">Taxa de Poupança: 40%</div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="card-title">Simulador de Futuro</span>
        </div>
        <p style="font-size: 0.8rem; color: #666; margin-bottom: 15px;">Projeção de liberdade financeira baseada em juros compostos.</p>

        <div class="input-row">
            <label class="input-label">Patrimônio Inicial</label>
            <input type="tel" class="money-input" id="calcInicial" value="15000" onkeyup="formatMask(this)">
        </div>

        <div class="input-row">
            <label class="input-label">Aporte Mensal</label>
            <input type="tel" class="money-input" id="calcAporte" value="1000" onkeyup="formatMask(this)">
        </div>

        <div class="input-row">
            <label class="input-label">Taxa Anual (%)</label>
            <input type="number" class="money-input" id="calcTaxa" value="10" style="width: 80px;">
        </div>

        <div class="input-row">
            <label class="input-label">Meta de Valor</label>
            <input type="tel" class="money-input" id="calcMeta" value="350000" onkeyup="formatMask(this)">
        </div>

        <button class="calc-btn" onclick="calcularJuros()">Calcular Tempo</button>

        <div class="calc-result-area" id="resultadoCalculadora">
            <div style="text-align: center;">
                <span style="color: #ccc; font-size: 0.9rem;">Para juntar <span id="resMetaDisplay" style="color: white;">R$ 350k</span>:</span>
                <h3 style="font-size: 1.6rem; color: var(--accent-yellow); margin: 10px 0;" id="resTempo">--</h3>
                <p style="font-size: 0.8rem; color: #666;">Total Investido: <span id="resInvestido">--</span></p>
                <p style="font-size: 0.8rem; color: #666;">Total em Juros: <span id="resJuros" style="color: var(--success);">--</span></p>
            </div>
        </div>
    </div>

    <script>
        // --- SETUP INICIAL ---
        let chartInstance = null;

        // 1. Função que formata dinheiro visualmente (R$ 1.000,00)
        function formatMask(input) {
            let value = input.value.replace(/\D/g, '');
            value = (value / 100).toFixed(2) + '';
            value = value.replace(".", ",");
            value = value.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1.');
            input.value = 'R$ ' + value;
        }

        // 2. Função que limpa a formatação para cálculo (Retorna Float)
        function parseVal(str) {
            if(!str) return 0;
            // Se for numero puro
            if(typeof str === 'number') return str;
            // Remove tudo menos numeros
            let clean = str.replace(/\D/g, '');
            return parseFloat(clean) / 100;
        }

        // 3. Formata Float para String Moeda
        function toMoney(floatVal) {
            return floatVal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        // --- DASHBOARD LÓGICA ---
        function updateDashboard() {
            // -- Patrimônio --
            const rf = parseVal(document.getElementById('valRF').value);
            const rv = parseVal(document.getElementById('valRV').value);
            const total = rf + rv;

            document.getElementById('totalPatrimonio').innerText = toMoney(total);
            
            // Atualiza Gráfico
            if(chartInstance) {
                chartInstance.data.datasets[0].data = [rf, rv];
                chartInstance.update();
            }

            // -- Fluxo Mensal --
            const salario = parseVal(document.getElementById('valSalario').value);
            
            // Soma despesas
            let despesas = 0;
            document.querySelectorAll('.expense-input').forEach(inp => {
                despesas += parseVal(inp.value);
            });

            const sobra = salario - despesas;
            const elAporte = document.getElementById('valAporte');
            elAporte.innerText = toMoney(sobra);

            // Cor condicional
            if(sobra < 0) elAporte.style.color = 'var(--danger)';
            else elAporte.style.color = 'var(--accent-yellow)';

            // Taxa de Poupança
            let rate = 0;
            if(salario > 0 && sobra > 0) rate = (sobra / salario) * 100;
            document.getElementById('taxaPoupanca').innerText = `Taxa de Poupança: ${rate.toFixed(1)}%`;
            
            // Atualiza inputs da calculadora automaticamente (opcional, mas legal para UX)
            // Se quiser que a calculadora pegue os valores do fluxo automaticamente, descomente:
            // document.getElementById('calcAporte').value = document.getElementById('valAporte').innerText;
        }

        // --- CALCULADORA LÓGICA ---
        function calcularJuros() {
            const inicial = parseVal(document.getElementById('calcInicial').value);
            const aporte = parseVal(document.getElementById('calcAporte').value);
            const meta = parseVal(document.getElementById('calcMeta').value);
            const taxaAnual = parseFloat(document.getElementById('calcTaxa').value);
            
            const taxaMensal = (taxaAnual / 100) / 12;

            if(aporte <= 0 && inicial < meta) {
                alert("O aporte mensal precisa ser maior que zero!");
                return;
            }

            let meses = 0;
            let montante = inicial;
            let totalInvestido = inicial;

            // Loop de juros compostos
            while (montante < meta && meses < 1200) { // Trava de segurança 100 anos
                montante = montante * (1 + taxaMensal) + aporte;
                totalInvestido += aporte;
                meses++;
            }

            const anos = Math.floor(meses / 12);
            const m = meses % 12;
            const jurosGanhos = montante - totalInvestido;

            // Exibir resultados
            document.getElementById('resultadoCalculadora').style.display = 'block';
            document.getElementById('resMetaDisplay').innerText = toMoney(meta);
            document.getElementById('resTempo').innerText = `${anos} anos e ${m} meses`;
            document.getElementById('resInvestido').innerText = toMoney(totalInvestido);
            document.getElementById('resJuros').innerText = toMoney(jurosGanhos);
        }

        // --- INICIALIZAÇÃO ---
        window.onload = function() {
            // Inicializa máscaras nos valores padrão
            document.querySelectorAll('.money-input').forEach(input => {
                if(input.id !== 'calcTaxa') { // Pula o input de porcentagem
                    let raw = parseFloat(input.value).toFixed(2).replace('.', '');
                    input.value = raw; 
                    formatMask(input);
                }
            });

            // Cria Gráfico
            const ctx = document.getElementById('investChart').getContext('2d');
            const rf = parseVal(document.getElementById('valRF').value);
            const rv = parseVal(document.getElementById('valRV').value);

            chartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Renda Fixa', 'Renda Variável'],
                    datasets: [{
                        data: [rf, rv],
                        backgroundColor: ['#333333', '#ffcc00'], // Cinza Escuro e Amarelo
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right', labels: { color: '#888', font: {size: 11}, boxWidth: 10 } }
                    },
                    cutout: '75%'
                }
            });

            // Roda cálculo inicial do dashboard
            updateDashboard();
        };
    </script>
</body>
</html>

